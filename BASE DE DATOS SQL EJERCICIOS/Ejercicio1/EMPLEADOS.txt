CREATE TABLE EMPLEADOS (
	NUMEMPLEADO NUMBER(4) CONSTRAINT PK_EMPLEADOS PRIMARY KEY,
	NOMBRE VARCHAR2(10),
	APELLIDO VARCHAR2(10),
	OFICIO VARCHAR2(10),
	DIR NUMBER(4),
	FECALTA DATE,
	SALARIO NUMBER(7),
	COMISION NUMBER(7),
	NUMDEPARTAMENTO NUMBER(2)
);

CREATE TABLE DEPARTAMENTOS (
	NUMDEPARTAMENTO NUMBER(2)CONSTRAINT PK_DEPARTAMENTOS PRIMARY KEY,
	NOMDEPARTAMENTO VARCHAR(14),
	LOC VARCHAR(14)
);

alter table EMPLEADOS
RENAME COLUMN DIR TO DIRECCION;

ALTER TABLE EMPLEADOS
MODIFY APELLIDO VARCHAR2(20);

ALTER TABLE EMPLEADOS
ADD DNI VARCHAR2(12);

ALTER TABLE EMPLEADOS
ADD PAIS VARCHAR2(12) DEFAULT 'ESPANA';

ALTER TABLE EMPLEADOS 
ADD CIUDAD VARCHAR2(14);

ALTER TABLE EMPLEADOS 
MODIFY FECALTA DATE DEFAULT SYSDATE;

ALTER TABLE EMPLEADOS 
ADD CONSTRAINT FK_NUMDEPARTAMENTO FOREIGN KEY (NUMDEPARTAMENTO) REFERENCES DEPARTAMENTOS(NUMDEPARTAMENTO);

ALTER TABLE EMPLEADOS 
MODIFY SALARIO NUMBER(7,2);

ALTER TABLE EMPLEADOS
MODIFY COMISION NUMBER(7,2);

ALTER TABLE DEPARTAMENTOS
RENAME COLUMN LOC TO CIUDAD;

ALTER TABLE DEPARTAMENTOS
ADD NUMEMPLEADO_JEFE NUMBER(4); 

INSERT INTO DEPARTAMENTOS VALUES ('10','CONTABILIDAD','SEVILLA','7505');
INSERT INTO DEPARTAMENTOS VALUES ('20','INFORMATICA','MURCIA ','7088');
INSERT INTO DEPARTAMENTOS VALUES ('30','ADMINISTRACION','MADRID ','7051');
INSERT INTO DEPARTAMENTOS VALUES ('40','PRODUCCIÓN','BILBAO ','1985');
INSERT INTO DEPARTAMENTOS VALUES ('50','ALMACEN','MURCIA ','7501');


INSERT INTO EMPLEADOS VALUES ('7369','ISABEL','SANCHEZ','EMPLEADO','Av. Libertad',TO_DATE ('03/01/2009', 'DD/MM/YYYY'),'1040',null,'20','48525150E','ESPAÑA','LEÓN');
INSERT INTO EMPLEADOS VALUES ('7499','MARÍA J','ARROYO','VENDEDOR','Calle laguna',TO_DATE ('02/11/2010', 'DD/MM/YYYY'),'1500','390 ','30','52474853P','ESPAÑA','BILBAO');
INSERT INTO EMPLEADOS VALUES ('7500','LUIS','SALA','VENDEDOR','Calle nº5',TO_DATE ('05/05/2015', 'DD/MM/YYYY'),'1625','650 ','8 ','87747525L','ESPAÑA','LISBOA');
INSERT INTO EMPLEADOS VALUES ('7501','REGINO','JIMENEZ','DIRECTOR','Calle n5',TO_DATE ('08/08/2008', 'DD/MM/YYYY'),'1520',null,'20','96654112F','ESPAÑA','PARIS');
INSERT INTO EMPLEADOS VALUES ('7502','MANUEL','MARTIN','VENDEDOR','Calle A',TO_DATE ('01/09/2015', 'DD/MM/YYYY'),'1600','1020','10','01478523R','ESPAÑA','ZARAGOZA');
INSERT INTO EMPLEADOS VALUES ('7505','PEDRO','NEGRO','DIRECTOR','Calle B',TO_DATE ('24/06/2000', 'DD/MM/YYYY'),'3005','250','30','00257485G','ESPAÑA','GERONA');
INSERT INTO EMPLEADOS VALUES ('7051','MARTÍN ','CEREZO','DIRECTOR','Calle C',TO_DATE ('15/03/2009', 'DD/MM/YYYY'),'1790','320','20','01020304H','ESPAÑA','ALMERIA');
INSERT INTO EMPLEADOS VALUES ('7088','ANA','GIL','ANALISTA','Av.Rocamora',TO_DATE ('10/03/2010', 'DD/MM/YYYY'),'3000','650','20','55224411W','ESPAÑA','MALAGA');
INSERT INTO EMPLEADOS VALUES ('7839','RICARDO','REY','PRESIDENTE','Av.Fernando Alonso',TO_DATE ('06/08/1999', 'DD/MM/YYYY'),'4000','1200','10','66885544E','ESPAÑA','GRANADA');
INSERT INTO EMPLEADOS VALUES ('288','SABEL','TOVAR','VENDEDOR','Calle Fortuna',TO_DATE ('08/09/2013', 'DD/MM/YYYY'),'1350','0','30','66558874R','ESPAÑA','BADAJOZ');
INSERT INTO EMPLEADOS VALUES ('7876','FERNANDO','ALONSO','EMPLEADO','Calle Ceutí',TO_DATE ('01/12/2018', 'DD/MM/YYYY'),'1430','875 ','20','98456321K','FRANCIA','MADRID');
INSERT INTO EMPLEADOS VALUES ('7900','CARLOS','JIMENO','EMPLEADO','Calle Almoradí',TO_DATE ('15/09/2014', 'DD/MM/YYYY'),'1335','970 ','30','45658525Q','PORTUGAL','BARCELONA');
INSERT INTO EMPLEADOS VALUES ('1985','FELIPE','FERNANDEZ','ANALISTA','Calle Molina de Segura',TO_DATE ('11/09/2016', 'DD/MM/YYYY'),'3000',null,'20','36323539S','ESPAÑA','SANTIAGO DE C.');
INSERT INTO EMPLEADOS VALUES ('7934','SOFIA','MUÑOZ','EMPLEADO','Av. Alto Atalayas',TO_DATE ('23/01/2012', 'DD/MM/YYYY'),'1690',null,'10','47512369D','ESPAÑA','MURCIA');

SELECT APELLIDO, OFICIO FROM EMPLEADOS;

SELECT DISTINCT OFICIO FROM EMPLEADOS 
ORDER BY OFICIO ASC;

SELECT * FROM EMPLEADOS 
WHERE FECALTA < TO_DATE('01/01/2011','DD/MM/YYYY');

SELECT APELLIDO, SALARIO, OFICIO FROM EMPLEADOS 
WHERE OFICIO = 'VENDEDOR' AND ( SALARIO BETWEEN 1500 AND 1600);

SELECT APELLIDO, NUMDEPARTAMENTO, NUMEMPLEADO FROM EMPLEADOS 
WHERE ((OFICIO = 'VENDEDOR' OR OFICIO = 'ANALISTA') AND NUMDEPARTAMENTO <> '30');

SELECT APELLIDO, NUMDEPARTAMENTO, NUMEMPLEADO FROM EMPLEADOS
WHERE ((OFICIO = 'VENDEDOR' OR OFICIO = 'ANALISTA') AND (NUMDEPARTAMENTO <> '30') AND ( APELLIDO NOT LIKE '%N'));

SELECT APELLIDO, SALARIO, COMISION, (SALARIO + COALESCE(COMISION, 0)) AS TOTAL FROM EMPLEADOS
WHERE COMISION IS NOT NULL ORDER BY TOTAL DESC;

SELECT * FROM EMPLEADOS WHERE ((OFICIO <> 'VENDEDOR') AND (OFICIO <> 'ANALISTA') AND (OFICIO <> 'DIRECTOR'));

SELECT * FROM EMPLEADOS WHERE FECALTA = (SELECT MAX(FECALTA) FROM EMPLEADOS);

SELECT * FROM EMPLEADOS WHERE FECALTA = (SELECT MIN(FECALTA) FROM EMPLEADOS);

SELECT D.NOMDEPARTAMENTO AS DEPARTMENT_NAME, AVG(E.SALARIO) AS AVERAGE_SALARY 
FROM EMPLEADOS E
JOIN DEPARTAMENTOS D ON D.NUMDEPARTAMENTO = E.NUMDEPARTAMENTO
GROUP BY D.NOMDEPARTAMENTO;

SELECT COUNT(*) AS NUM_EMPLEADOS FROM EMPLEADOS;